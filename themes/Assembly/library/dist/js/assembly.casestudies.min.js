/* repo: assembly/ - Package Version: 1.0.0 - 2017-04-11 10:08 pm - User: Phoydar */
var assembly=assembly||{};!function($){assembly.casestudies={init:function(){this.$landing=$(".landing"),this.$landingSquares=$(".landing .case-study-category"),this.$customLanding=$('.case-study-landing[data-kit-type="custom"]'),this.$modularLanding=$('.case-study-landing[data-kit-type="modular"]'),this.$mainContent=$(".content"),this.mainContentHeight=$(".content").height(),this.$caseStudyLandingTiles=$(".case-study-landing .tile"),this.$selectFilter=$(".select-filter"),this.$toggleFilter=$(".toggle-filter"),this.$toggleFilterBtns=$(".toggle-filter a"),this.$filterMenuLinks=$(".filter-menu a"),this.$filterWrap=$(".filter-wrap"),this.$filterMenu=$(".filter-menu"),this.$caseStudyContainers=$(".case-study-container"),this.$currentCaseStudyContainer={},this.currentFilerStatus={type:"custom",category:"all"},this.initSelect2(),this.bindEvents(),this.addClassTileCount()},initSelect2:function(){this.select2Filter=this.$selectFilter.select2({minimumResultsForSearch:-1})},bindEvents:function(){function setLandingSelection(){_this.showMainCaseStudies(_this.$selectedLandingTile),$(".toggle-filter a").removeClass("active"),$(".toggle-filter [title="+_this.$selectedLandingType+"]").addClass("active")}var _this=this;_this.$selectFilter.on("change",function(evt){_this.filterProjectsByCategory(this.value)}),_this.$filterMenuLinks.on("click",function(evt){evt.preventDefault(),$(this).parent().is(".active")||(_this.setFilterLinksClass($(this).parent()),_this.filterProjectsByCategory($(this).parent().data("value")))}),$(".back-box").on("click",function(evt){evt.stopPropagation(),$('[data-value="all"] a').trigger("click")}),_this.$toggleFilterBtns.on("click",function(evt){evt.preventDefault(),_this.toggleCaseStudyType(this)}),_this.$caseStudyLandingTiles.on("click",function(evt){var kitType=$(this).closest(".case-study-container").attr("data-kit-type"),category=$(this).find(".tile-cat").html().trim().toLowerCase();_this.currentFilerStatus.type=kitType,_this.currentFilerStatus.category=category,_this.$selectFilter.val(category).trigger("change"),_this.setFilterLinksClass($('[data-value="'+category+'"]'))}),_this.$landingSquares.on("click",function(evt){var $square=$(this),$type=$(this).is(".modular")?"modular":"custom";$(this).removeClass("hover").addClass("selected"),$(".hover-spot").off("hover"),_this.$selectedLandingTile=$square,_this.$selectedLandingType=$type,$(this).is(".transitioning")||setLandingSelection()}),$(".case-study-category .default-content").on(transEndEventName,function(evt){$(this).parent().removeClass("transitioning"),$(evt.target).parent().is(".selected")&&setLandingSelection()}).children().on(transEndEventName,function(evt){evt.stopPropagation()}),assembly.util.env.$win.on("scroll-down",function(){$(".scroll-overlay").addClass("going-down"),$(".scroll-overlay").removeClass("going-up"),_this.$filterWrap.hasClass("show")&&$(".landing-inner").hasClass("hide")&&_this.$filterWrap.removeClass("show")}),assembly.util.env.$win.on("scroll-up",function(){$(".scroll-overlay").addClass("going-up"),$(".scroll-overlay").removeClass("going-down"),!_this.$filterWrap.hasClass("show")&&$(".landing-inner").hasClass("hide")&&_this.$filterWrap.addClass("show")}),assembly.util.env.$win.on("windowResize",function(){"undefined"!=typeof _this.$currentCaseStudyContainer.outerHeight&&$(".case-study-details").css({height:_this.$currentCaseStudyContainer.outerHeight()})}),$(".view-case-study").on("click",function(evt){evt.preventDefault(),_this.$currentCaseStudyContainer.removeClass("show"),_this.currentFilerStatus.type=$(this).data("title"),$("html, body").animate({scrollTop:0},1e3),_this.showCaseStudyContent()}),$(".hover-spot").hover(function(){$(this).parent().addClass("hover transitioning")},function(){$(this).parent().removeClass("hover transitioning")}),$(".case-study-svg-cat .main").hover(function(){$(this).closest(".case-study-svg-cat").is(".activated")||$(this).closest(".case-study-svg-cat").addClass("hover")},function(){$(this).closest(".case-study-svg-cat").removeClass("hover")}),$(".case-study-svg-cat").on("click",function(evt){evt.preventDefault();var cat=$(this).data("svg-case-study-cat");$(this).removeClass("hover"),_this.setFilterLinksClass($(".filter-menu [data-value="+cat+"]")),_this.filterProjectsByCategory($(this).data("svg-case-study-cat"))}),_this.$landing.mousemove(function(){_this.parallaxBg()}),window.location.hash&&$("html").on("loaded",function(){setTimeout(function(){$('[data-hash-selector="'+window.location.hash+'"] .hover-spot').trigger("mouseover"),$('[data-hash-selector="'+window.location.hash+'"]').trigger("click")},500)})},lazyLoadImages:function($container){if(!$container.hasClass("imagesLoaded")){var totalImages=$(".tile-img.lazy-load",$container).length,totalImagesLoaded=0;$(".tile-img.lazy-load",$container).each(function(i,tile){var $tile=$(tile),$imgContainer=$tile.find(".img-container"),$img=$tile.find("img"),imgSrc=$img.data("src"),imagesLoaded=$tile.imagesLoaded();$imgContainer.addClass("is-loading"),$img.attr("src",imgSrc),imagesLoaded.progress(function(loader,image){$imgContainer.removeClass("is-loading").addClass("is-loaded"),totalImagesLoaded++,totalImagesLoaded===totalImages&&($container.trigger("allImagesLoaded"),$container.addClass("imagesLoaded"))})})}},parallaxBg:function(){},showMainCaseStudies:function($landingTileClicked){var cat,_this=this;cat=$landingTileClicked.data("landing-cat"),_this.lazyLoadImages($('[data-category="all"][data-kit-type="'+cat+'"]')),_this.currentFilerStatus.category="all",$landingTileClicked.is(".modular")?($toShow=_this.$modularLanding,_this.currentFilerStatus.type="modular",_this.$modularLanding.addClass("show"),_this.$customLanding.removeClass("show"),$('[data-title="modular"]').removeClass("show"),$('[data-title="custom"]').addClass("show"),$('[data-h2-title="modular"]').addClass("show"),$('[data-h2-title="custom"]').removeClass("show"),$(".case-study-svg.modular").addClass("show"),$(".case-study-svg.custom").removeClass("show")):($toShow=_this.$customLanding,_this.currentFilerStatus.type="custom",_this.$customLanding.addClass("show"),_this.$modularLanding.removeClass("show"),$('[data-title="modular"]').addClass("show"),$('[data-title="custom"]').removeClass("show"),$('[data-h2-title="modular"]').removeClass("show"),$('[data-h2-title="custom"]').addClass("show"),$(".case-study-svg.modular").removeClass("show"),$(".case-study-svg.custom").addClass("show")),_this.$currentCaseStudyContainer=$toShow,$(".case-study-details").css({height:$toShow.outerHeight()}),$(".landing-inner").addClass("hide"),$(".filter-wrap").addClass("show"),setTimeout(function(){$(".scroll-overlay").addClass("fixme")},1500),$("html").addClass("landing-closed")},addClassTileCount:function(){this.$caseStudyContainers.each(function(i,caseStudyContainers){$(caseStudyContainers).find(".tile").each(function(tileIndex,tile){$(tile).addClass("tile-"+(tileIndex+1))})})},toggleCaseStudyType:function(toggleBtn){$(toggleBtn).is(".active")||($(toggleBtn).is(".active")?($(".toggle-filter a:not(.active)").addClass("active"),$(toggleBtn).siblings().removeClass("active")):($(".toggle-filter a.active").removeClass("active"),$(toggleBtn).addClass("active")),this.currentFilerStatus.type=$(".toggle-filter a.active").attr("title"),this.showCaseStudyContent())},filterProjectsByCategory:function(option){this.currentFilerStatus.category=option,this.showCaseStudyContent()},setFilterLinksClass:function($linkParent){$linkParent.is("active")||($(".filter-menu .active").removeClass("active"),$linkParent.addClass("active"))},showCaseStudyContent:function(){var _this=this,cat=this.currentFilerStatus.category,type=this.currentFilerStatus.type,$toShow=$('[data-kit-type="'+type+'"][data-category="'+cat+'"]'),$svgStage=$(".case-study-svg."+type),$svgToShow=($svgStage.siblings().removeClass("active"),$(".case-study-svg."+type+' [data-svg-case-study-cat="'+cat+'"]')),$activeSvg=$(".case-study-svg."+type+" .case-study-svg-cat.active");_this.lazyLoadImages($toShow),"all"===this.currentFilerStatus.category?($(".case-study-svg."+type+" .case-study-svg-cat").removeClass("inactive hide activate"),$activeSvg.removeClass("active"),$svgStage.removeClass("active")):($activeSvg.removeClass("active").addClass("hide"),$svgToShow.siblings(".case-study-svg-cat").removeClass("active").addClass("inactive"),$svgToShow.removeClass("hide inactive").addClass("activate"),$svgStage.is(".active")&&$svgToShow.removeClass("activate").addClass("active"),$svgToShow.one(animationEndEventName,function(evt){$svgStage.addClass("active"),$svgToShow.removeClass("activate").addClass("active")})),"modular"===type?($('[data-title="modular"]').removeClass("show"),$('[data-title="custom"]').addClass("show"),$('[data-h2-title="modular"]').addClass("show"),$('[data-h2-title="custom"]').removeClass("show"),$(".case-study-svg.modular").addClass("show"),$(".case-study-svg.custom").removeClass("show")):($('[data-title="modular"]').addClass("show"),$('[data-title="custom"]').removeClass("show"),$('[data-h2-title="modular"]').removeClass("show"),$('[data-h2-title="custom"]').addClass("show"),$(".case-study-svg.custom").addClass("show"),$(".case-study-svg.modular").removeClass("show")),this.$currentCaseStudyContainer.removeClass("show"),$toShow.addClass("show"),$(".case-study-details").css({height:$toShow.outerHeight()}),this.$currentCaseStudyContainer=$toShow}},$(function(){assembly.casestudies.init()})}(jQuery);