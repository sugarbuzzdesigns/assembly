/* repo: assembly/ - Package Version: 1.0.0 - 2017-02-23 12:04 am - User: Phoydar */
var assembly=assembly||{};!function($){assembly.contact={init:function(){this.$addPhotoSection=$(".add-photo"),this.$pagerCurrent=$(".pager .current"),this.$addphotoButton=$(".add-photo-overlay .add-photo-btn"),this.$addPhotoIcon=$(".open-add-images"),this.$addedPhotosList=$(".photos-wrap .photos"),this.addedPhotosArray=[],this.photosListCarouselCurSlide="",this.addPhotosCarouselCurSlide="",this.initContactForm(),this.initCarousels(),this.bindEvents(),this.setInitialSectionHeights()},bindEvents:function(){var _this=this;$("form button").on("click",function(){_this.validField($(this).closest("form").find(".active input").val())?(_this.showNextFormInput($(this).closest("form").find(".active")),$("form .error-message").hide()):$("form .error-message").show()}),_this.$addPhotoSection.find(".close-btn").on("click",function(){_this.closeAddContactPhotoWrap()}),_this.$addPhotoIcon.on("click",function(){}),_this.$addphotoButton.on("click",function(evt){evt.preventDefault(),_this.addPhotoToPhotosList()}),_this.$addPhotosCarousel.on("changed.owl.carousel",function(event){_this.setCurrentCarouselSlide("addPhotosCarouselCurSlide",$(this).data("owl.carousel").items()[event.item.index])})},setInitialSectionHeights:function(){this.$photoOverlayWrap=$(".photo-overlay-wrap"),this.photoOverlayWrapHeight=this.$photoOverlayWrap.height(),this.$photoOverlayWrap.data("originalHeight",this.photoOverlayWrapHeight)},initCarousels:function(){var _this=this;_this.$addPhotosCarousel=$(".add-photos-carousel"),_this.$addPhotosCarousel.on("initialized.owl.carousel",function(){_this.setCurrentCarouselSlide("addPhotosCarouselCurSlide",$(this).find(".owl-item").eq(0)),$(".add-photos-carousel-wrap").find("nav .arrow-right").on("click",function(){_this.$addPhotosCarousel.data("owl.carousel").next()}),$(".add-photos-carousel-wrap").find("nav .arrow-left").on("click",function(){_this.$addPhotosCarousel.data("owl.carousel").prev()})}),_this.$addPhotosCarousel.on("changed.owl.carousel",function(evt){var items_per_page=evt.relatedTarget.options.slideBy,item_index=evt.item.index,last_vis_item_index=(evt.item.count,items_per_page+item_index);console.log(last_vis_item_index),0===evt.page.index&&$(".add-photos-carousel-wrap").find("nav .arrow-left").addClass("disabled"),0===evt.page.index&&$(".add-photos-carousel-wrap").find("nav .arrow-left").addClass("disabled")}),_this.$addPhotosCarousel.owlCarousel({items:"desktop"===assembly.util.useragent.deviceType?5:1,stagePadding:"desktop"===assembly.util.useragent.deviceType?0:50}),_this.$photoListCarousel=$(".photo-list-carousel"),_this.$photoListCarousel.on("initialized.owl.carousel",function(){_this.setCurrentCarouselSlide("photosListCarouselCurSlide",$(this).find(".owl-item").eq(0))}),_this.photoListCarouselSettings={items:1,rtl:!0,margin:20,stagePadding:50},_this.$photoListCarousel.owlCarousel(_this.photoListCarouselSettings),_this.photoListOwl=_this.$photoListCarousel.data("owl.carousel")},openAddContactPhotoWrap:function(){this.$photoOverlayWrap.animate({height:this.$photoOverlayWrap.data().originalHeight},500),$("body, html").animate({scrollTop:$(".add-photo").offset().top})},closeAddContactPhotoWrap:function(){this.$photoOverlayWrap.animate({height:0},500)},setCurrentCarouselSlide:function(sliderName,slide){this[sliderName]=slide},initContactForm:function(){var formFields=$("form label"),numFormFields=formFields.length,$cur=this.$pagerCurrent,$total=$(".pager .total");$cur.html("1"),$total.html(numFormFields)},validField:function(fieldValue){return!!fieldValue},showNextFormInput:function($currentInput){var curIndex=$currentInput.index()+1;curIndex===$("form label").length?$("html, body").animate({scrollTop:$(".add-photo").offset().top}):(this.$pagerCurrent.html(curIndex+1),$currentInput.removeClass("active"),$currentInput.next().addClass("active"))},addPhotoToPhotosList:function(){var numSlides=this.$photoListCarousel.data("owl.carousel").items().length,$photoDiv=this.addPhotosCarouselCurSlide.find(".image"),photoId=$photoDiv.data("photo-id"),$photoToAdd=$photoDiv.find("img"),photoSrc=$photoToAdd.attr("src"),$photo=$('<div id="'+photoId+'" class="photo" style="background-image: url('+photoSrc+');"></div>');$.inArray(photoId,this.addedPhotosArray)===-1&&(this.addedPhotosArray.push(photoId),numSlides<=1?(this.$photoListCarousel.data("owl.carousel").destroy(),this.$addPhotoIcon.after($photo)):(this.$photoListCarousel.data("owl.carousel").add($photo,1),this.$photoListCarousel.data("owl.carousel").destroy()),this.$photoListCarousel.owlCarousel({items:2,rtl:!0,margin:20,stagePadding:50}))}},$(function(){assembly.contact.init()})}(jQuery);