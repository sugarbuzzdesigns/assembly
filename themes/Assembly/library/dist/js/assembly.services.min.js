/* repo: assembly/ - Package Version: 1.0.0 - 2017-04-25 10:06 am - User: Phoydar */
var assembly=assembly||{};!function($){assembly.services={init:function(){this.$selectFilter=$(".select-filter"),this.$filterMenu=$(".filter-menu"),this.$filterMenuLinks=$(".filter-menu a"),this.$servicesContainer=$(".content"),this.initSelect2(),this.bindEvents(),this.waypoints(),this.countTilesAndAddClass(),this.$currentServiceContainer=$(".all-services"),this.setInitialContainerHeights(),this.browserScrolled=!1,assembly.util.env.$win.scrollTop()>0&&(this.browserScrolled=!0)},initSelect2:function(){this.select2Filter=this.$selectFilter.select2({minimumResultsForSearch:-1,width:"100%"})},setInitialContainerHeights:function(){console.log("set setInitialContainerHeights"),this.$servicesContainer.css({height:this.$currentServiceContainer.height()})},bindEvents:function(){var _this=this;_this.$selectFilter.on("change",function(evt){_this.filterProjectsByCategory(this.value)}),_this.$filterMenuLinks.on("click",function(evt){evt.preventDefault(),$(this).parent().siblings().removeClass("active"),$(this).parent().addClass("active"),_this.filterProjectsByCategory($(this).parent().data("value"))}),assembly.util.env.$win.on("scroll-down",function(){return _this.browserScrolled?void(_this.browserScrolled=!1):($("header.fixed").addClass("going-down"),$("header.fixed").removeClass("going-up"),void(_this.$filterMenu.hasClass("show")&&$(window).scrollTop()>50&&_this.$filterMenu.removeClass("show")))}),assembly.util.env.$win.on("scroll-up",function(){"undefined"!=typeof assembly.scrollAnimating&&assembly.scrollAnimating===!1&&($("header.fixed").addClass("going-up"),$("header.fixed").removeClass("going-down")),_this.$filterMenu.hasClass("show")||_this.$filterMenu.addClass("show")}),assembly.util.env.$win.on("scroll",function(){$(".tile").each(function(i,tile){})}),assembly.util.env.$win.on("windowResize",function(){"desktop"===assembly.util.useragent&&_this.$servicesContainer.css({height:_this.$currentServiceContainer.outerHeight()})}),$(".all-services .tile").on("click",function(e){e.preventDefault(),_this.filterProjectsByCategory($(this).data("service-id"),!0),$(".filter-menu [data-value].active").removeClass("active"),$('.filter-menu [data-value="'+$(this).data("service-id")+'"]').addClass("active"),_this.$selectFilter.val($(this).data("service-id")).trigger("change")}),_this.loadServicesImages($(".all-services.show")),$("html").on("loaded",function(){$(".main-logo").each(function(i,mainLogo){window.greensockLogoAnimation($(mainLogo))})})},loadServicesImages:function($container){if(!$container.hasClass("imagesLoaded")){var totalImages=$(".tile-img.lazy-load",$container).length,totalImagesLoaded=0;$(".tile-img.lazy-load",$container).each(function(i,tile){var $tile=$(tile),$imgContainer=$tile.find(".img-container"),$img=$tile.find("img"),imgSrc=$img.data("src"),imagesLoaded=$tile.imagesLoaded();$imgContainer.addClass("is-loading"),$img.attr("src",imgSrc),imagesLoaded.progress(function(loader,image){$imgContainer.removeClass("is-loading").addClass("is-loaded"),totalImagesLoaded++,totalImagesLoaded===totalImages&&($container.trigger("allImagesLoaded"),$container.addClass("imagesLoaded"))})})}},setInitialTranslate:function(elm){$(".tile").each(function(i,tile){})},setTranslate:function(elm,onload){var $elm=$(elm),firstTop=$elm.offset().top-$elm.offsetParent().offset().top,winScrollTop=$(window).scrollTop(),shiftDistance=(firstTop-winScrollTop)*$elm.data("speed");($elm.is(".inview")||onload)&&$elm.css({transform:"translate3d(0,"+shiftDistance+"px,0)"})},waypoints:function(){$(".tile").each(function(i,tile){new Waypoint.Inview({element:$(tile)[0],enter:function(direction){$(tile).addClass("inview")},exited:function(direction){$(tile).removeClass("inview")}})})},countTilesAndAddClass:function(){$(".content.landing").find(".tile").each(function(tileNum,tile){$(tile).addClass("tile-"+(tileNum+1))}),$(".content.dynamic .individual-service").each(function(serviceNum,service){$(service).find(".tile").each(function(serviceTileNum,tile){$(tile).addClass("tile-"+(serviceTileNum+1))})})},filterProjectsByCategory:function(option,tileClick){var _this=this,$serviceToHide=($('[data-service="all"]'),$("[data-service]"),$("[data-service].show")),$serviceToShow=$('[data-service="'+option+'"]');$serviceToShow.hasClass("show")||(_this.loadServicesImages($serviceToShow),$serviceToHide.removeClass("show").addClass("hide"),$serviceToShow.removeClass("hide").addClass("show"),"desktop"!==assembly.util.useragent.deviceType?setTimeout(function(){_this.$servicesContainer.css({height:$serviceToShow.outerHeight()})},400):_this.$servicesContainer.css({height:$serviceToShow.outerHeight()}),"desktop"!==assembly.util.useragent.deviceType&&tileClick&&(assembly.scrollAnimating=!0,$("html, body").delay(500).animate({scrollTop:$(".mobile-filter").offset().top-20},1e3,"easeOutCubic",function(){assembly.scrollAnimating=!1})))}},$(function(){assembly.services.init()})}(jQuery);